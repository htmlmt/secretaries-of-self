<div class="body--cabinets">
  <% if current_user != nil %>
    <% if @cabinets.count != 0 %>
      <% @cabinets.each do |cabinet| %>
        <% if cabinet.user_id == current_user.id %>
          <div class="cabinets--heading">
            <h1>Form your cabinet</h1>
          </div>
          <div class="cabinets--mine">
            <div class="mine--list">
              <div class="list--president">
                <h3>President:</h3> 
                <h2><%= current_user.first_name %> <%= current_user.last_name %></h3>
              </div>
            </div>
            <div class="mine--add">
              <% if cabinet.users != [] %>
                <% cabinet.users.each do |user| %>
                  <div class="mine--add">
                    <input type="text">
                  </div>
                <% end %>
              <% else %>
                <div class="mine--secretary">
                  <div class="secretary--prompt">
                    Add a secretary to your cabinet:
                  </div>
                  <div class="secretary--pick">
                    <ul class="pick--list">
                      <li class="list--item">
                        <div class="item--select">
                          <div class="select--text" data-secretary="work">
                            <h4 class="text--heading">Secretary of Work</h4>
                          </div>
                          <div class="select--plus">
                            +
                          </div>
                        </div>
                      </li>
                      <li class="list--item">
                        <div class="item--select">
                          <div class="select--text" data-secretary="love">
                            <h4 class="text--heading">Secretary of Love</h4>
                          </div>
                          <div class="select--plus">
                            +
                          </div>
                        </div>
                      </li>
                      <li class="list--item">
                        <div class="item--select">
                          <div class="select--text" data-secretary="faith">
                            <h4 class="text--heading">Secretary of Faith</h4>
                          </div>
                          <div class="select--plus">
                            +
                          </div>
                        </div>
                      </li>
                      <li class="list--item">
                        <div class="item--select">
                          <div class="select--text" data-secretary="good">
                            <h4 class="text--heading">Secretary of Good</h4>
                          </div>
                          <div class="select--plus">
                            +
                          </div>
                        </div>
                      </li>
                      <li class="list--item">
                        <div class="item--select">
                          <div class="select--text" data-secretary="money">
                            <h4 class="text--heading">Secretary of Money</h4>
                          </div>
                          <div class="select--plus">
                            +
                          </div>
                        </div>
                      </li>
                    </ul>
                    <div class="pick--new">
                      <div class="new--secretary">
                        <div class="secretary--text">
                          Add your own kind of secretary:
                        </div>
                        <div class="secretary--input">
                          <label>
                            Secretary of
                          </label>
                          <input class="input--secretary" type="text" name="secretary">
                        </div>
                        <div class="secretary--input">
                          <input class="input--first-name" type="text" placeholder="Secretary's first name">
                        </div>
                        <div class="secretary--input">
                          <input class="input--last-name" type="text" placeholder="Secretary's last name">
                        </div>
                        <div class="secretary--input">
                          <input class="input--email" type="text" placeholder="Secretary's email address">
                        </div>
                        <div class="secretary--submit">
                          Add secretary
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% else %>
          <div class="cabinets--theirs">
            <% cabinet.users.each do |user| %>
              <div class="theirs--cabinet">
                <div class="cabinet--secretary">
                  <%= user.first_name %> <%= user.last_name %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      <% end %>
    <% end %>
  <% else %>
  
  <% end %>
</div>
<script>
var secretaryToggles = $('.item--select');
secretaryToggles.click(function(){
  if ($(this).hasClass('open')) {
    $(this).siblings('.item--input').remove();
    $(this).siblings('.item--submit').remove();
    $(this).parent().css('cursor', 'pointer');
    $(this).children('.select--plus').css('transform', 'rotate(0deg)');
    $(this).removeClass('open');
  } else {
    var secretary = $(this).children('.select--text').children('.text--heading').data('secretary');
    $(this).parent().append('<input class="item--input item--first-name" type="text" placeholder="Secretary\'s first name" name="first_name"><input class="item--input item--last-name" type="text" placeholder="Secretary\'s last name" name="last_name"><input class="item--input item--email" type="text" placeholder="Secretary\'s email address" id="' + secretary + '" name="' + secretary + '"><div class="item--submit">Add secretary</div>');
    $(this).children('.select--plus').css('transform', 'rotate(45deg)');
    $(this).addClass('open');
    $('.item--submit').click(function(){
      var secretaryName = $(this).siblings('.item--first-name').val() + ' ' + $(this).siblings('.item--last-name').val();
      var secretary = $(this).siblings('.item--select').children('.select--text').children('.text--heading').html();
      $('.mine--list').append('<div class="list--secretary"><h3>' + secretary + ':</h3><h2>' + secretaryName + '</h2></div>');
      $(this).parent().hide();
    });
  }
});

$('.secretary--submit').click(function(){
  var secretary = $(".secretary--input .input--secretary").first().val();
  var firstName = $(".secretary--input .input--first-name").first().val();
  var lastName = $(".secretary--input .input--last-name").first().val();
  $(".secretary--input .input--secretary").first().val("");
  $(".secretary--input .input--first-name").first().val("");
  $(".secretary--input .input--last-name").first().val("");
  $(".secretary--input .input--email").first().val("");
  $('.mine--list').append('<div class="list--secretary"><h3>Secretary of ' + secretary + ':</h3><h2>' + firstName + ' ' + lastName + '</h2></div>');
});
</script>